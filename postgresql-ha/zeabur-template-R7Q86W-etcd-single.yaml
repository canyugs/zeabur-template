# yaml-language-server: $schema=https://schema.zeabur.app/template.json
apiVersion: zeabur.com/v1
kind: Template
metadata:
  name: etcd Node (Single node, for postgresql-ha)
spec:
  description: |
    Add additional etcd nodes to an existing etcd cluster. Use this to scale your cluster for higher availability or replace failed nodes.
  icon: https://raw.githubusercontent.com/cncf/artwork/master/projects/etcd/icon/color/etcd-icon-color.svg
  coverImage: https://etcd.io/img/etcd-horizontal-color.svg
  tags:
    - Database
    - etcd
    - Distributed System
    - High Availability
  variables:
    - key: ETCD_NODE_NAME
      type: STRING
      name: Node Name
      description: Unique name for this etcd node (e.g., etcd4, etcd5)
    - key: ETCD_CLUSTER_TOKEN
      type: STRING
      name: Cluster Token
      description: Cluster token (must match existing cluster if joining)
    - key: ETCD_INITIAL_CLUSTER
      type: STRING
      name: Initial Cluster
      description: All cluster members (e.g., etcd1=http://etcd1:2380,etcd2=http://etcd2:2380,etcd4=http://etcd4:2380)
  readme: |
    # etcd Node (Cluster Expansion)

    This template allows you to add additional etcd nodes to an existing etcd cluster. Use this to scale your cluster for higher availability or replace failed nodes.

    ## ğŸ¯ Designed For

    This template is specifically designed to expand the **[PostgreSQL HA](https://zeabur.com/zh-TW/templates/IOYTRN)** template cluster.

    If you haven't deployed the base cluster yet, please deploy the [PostgreSQL HA template](https://zeabur.com/zh-TW/templates/IOYTRN) first.

    ## Use Cases

    1. **Expand existing cluster**: Scale from 3 to 5 nodes for higher availability
    2. **Replace failed node**: Deploy a new node to replace a failed cluster member
    3. **Create new cluster**: Start a new etcd cluster (advanced use)

    ## Prerequisites

    - **Existing etcd cluster** (if joining): You need an operational etcd cluster
    - **Cluster information**: You need to know:
      - Cluster token (e.g., `etcd-cluster-pg-ha`)
      - All existing member endpoints
      - Whether adding to existing cluster or creating new one

    ## Configuration Variables

    ### Node Identity

    - **Node Name**: Unique identifier for this etcd node
      - **Must be unique** within the cluster
      - Examples: `etcd4`, `etcd5`, `etcd-node-4`, etc.
      - **Avoid conflicts**: Check existing node names before deploying

    ### Cluster Configuration

    - **Cluster Token**: Shared secret for the cluster
      - **Join existing cluster**: Use the same token as existing nodes (e.g., `etcd-cluster-pg-ha`)
      - **New cluster**: Create a unique token

    - **Initial Cluster**: Comma-separated list of all cluster members
      - **Format**: `name1=http://host1:2380,name2=http://host2:2380,...`
      - **Must include this new node** and all existing nodes
      - **Example**: `etcd1=http://etcd1:2380,etcd2=http://etcd2:2380,etcd3=http://etcd3:2380,etcd4=http://etcd4:2380`

    ## âš ï¸ Important: Rename Service After Deployment

    When you deploy this template, the service will be named `etcd` by default. **You must rename both the service and the internal network** to match your desired node name.

    For example, if you're adding the 4th etcd node:
    1. **Rename service**: `etcd` â†’ `etcd4`
    2. **Rename internal network**: `etcd` â†’ `etcd4`

    This ensures the service hostname matches the node name configured in the cluster.

    ## Adding to Existing Cluster (Recommended Process)

    ### Step 1: Add Member to Cluster

    Before deploying this template, add the new member to the existing cluster:

    ```bash
    # Using HTTP API (from any machine with access to etcd):
    # Note: Replace "etcd4" with your actual service name
    curl -X POST http://etcd1:2379/v3/cluster/member/add \
      -d '{"peerURLs":["http://etcd4:2380"]}'
    ```

    This will output the updated cluster configuration.

    ### Step 2: Deploy This Template

    Use the configuration from Step 1:

    ```
    Node Name: etcd4
    Cluster Token: etcd-cluster-pg-ha      # Same as existing cluster
    Initial Cluster: etcd1=http://etcd1:2380,etcd2=http://etcd2:2380,etcd3=http://etcd3:2380,etcd4=http://etcd4:2380
    ```

    ### Step 3: Verify

    Check cluster health:

    ```bash
    curl http://etcd1:2379/health
    curl -X POST http://etcd1:2379/v3/cluster/member/list
    ```

    ## Example: 3-Node to 5-Node Expansion

    Assuming you've deployed the [PostgreSQL HA template](https://zeabur.com/zh-TW/templates/IOYTRN):

    ### Current 3-Node Cluster

    - etcd1: http://etcd1:2380
    - etcd2: http://etcd2:2380
    - etcd3: http://etcd3:2380
    - Cluster Token: `etcd-cluster-pg-ha` (default token used by PostgreSQL HA template)

    ### Adding Node 4

    1. Add member:
       ```bash
       curl -X POST http://etcd1:2379/v3/cluster/member/add -d '{"peerURLs":["http://etcd4:2380"]}'
       ```
    2. Deploy with:
       - Node Name: `etcd4`
       - Cluster Token: `etcd-cluster-pg-ha`
       - Initial Cluster: `etcd1=http://etcd1:2380,etcd2=http://etcd2:2380,etcd3=http://etcd3:2380,etcd4=http://etcd4:2380`

    ### Adding Node 5

    1. Add member:
       ```bash
       curl -X POST http://etcd1:2379/v3/cluster/member/add -d '{"peerURLs":["http://etcd5:2380"]}'
       ```
    2. Deploy with:
       - Node Name: `etcd5`
       - Cluster Token: `etcd-cluster-pg-ha`
       - Initial Cluster: `etcd1=http://etcd1:2380,etcd2=http://etcd2:2380,etcd3=http://etcd3:2380,etcd4=http://etcd4:2380,etcd5=http://etcd5:2380`

    ## Cluster Sizing Recommendations

    | Nodes | Fault Tolerance | Quorum | Use Case |
    |-------|----------------|--------|----------|
    | 1     | 0 failures     | 1/1    | Development only |
    | 3     | 1 failure      | 2/3    | Production (standard) âœ… |
    | 5     | 2 failures     | 3/5    | Production (high availability) âœ… |

    âš ï¸ **Do not use 2 or 4 nodes**: Even-numbered clusters don't improve fault tolerance over n-1 nodes.

    ## Network Ports

    This node exposes:
    - **2379**: Client requests (HTTP/gRPC)
    - **2380**: Peer communication
    - **2381**: Metrics endpoint

    Ensure these ports are accessible from:
    - Other etcd nodes (peer communication)
    - Patroni/PostgreSQL nodes (client access)
    - Monitoring systems (metrics)

    ## Removing a Node

    To remove this node from the cluster:

    ```bash
    # 1. Get member ID (using HTTP API)
    curl -X POST http://etcd1:2379/v3/cluster/member/list

    # 2. Remove member (using HTTP API)
    curl -X POST http://etcd1:2379/v3/cluster/member/remove -d '{"ID":"<member-id>"}'

    # 3. Stop/delete this service in Zeabur
    ```

    âš ï¸ **Never reduce below 3 nodes in production** - this breaks HA guarantees

    ## Important Notes

    âš ï¸ **Add members one at a time**: Wait for each new node to sync before adding the next

    âš ï¸ **Cluster token must match**: When joining existing cluster, use the same token

    âš ï¸ **Update Patroni configuration**: After adding etcd nodes, update `ETCD3_HOSTS` in all Patroni services to include new nodes

    ## Monitoring

    Check node health:
    - Metrics: `http://<node-hostname>:2381/metrics`
    - Health: `curl http://<node-hostname>:2379/health`
    - Member list: `curl -X POST http://<node-hostname>:2379/v3/cluster/member/list`

    ## Documentation

    - [etcd Documentation](https://etcd.io/docs/)
    - [Runtime Reconfiguration](https://etcd.io/docs/latest/op-guide/runtime-configuration/)
    - [Clustering Guide](https://etcd.io/docs/latest/op-guide/clustering/)

  services:
    - name: etcd
      icon: https://raw.githubusercontent.com/cncf/artwork/master/projects/etcd/icon/color/etcd-icon-color.svg
      template: PREBUILT
      spec:
        source:
          image: gcr.io/etcd-development/etcd:v3.6.6
        ports:
          - id: client
            port: 2379
            type: TCP
          - id: peer
            port: 2380
            type: TCP
          - id: metrics
            port: 2381
            type: HTTP
        volumes:
          - id: data
            dir: /etcd-data
        env:
          ETCD_NAME:
            default: ${ETCD_NODE_NAME}
          ETCD_DATA_DIR:
            default: /etcd-data
          ETCD_INITIAL_ADVERTISE_PEER_URLS:
            default: http://${CONTAINER_HOSTNAME}:2380
          ETCD_LISTEN_PEER_URLS:
            default: http://0.0.0.0:2380
          ETCD_LISTEN_CLIENT_URLS:
            default: http://0.0.0.0:2379
          ETCD_ADVERTISE_CLIENT_URLS:
            default: http://${CONTAINER_HOSTNAME}:2379
          ETCD_LISTEN_METRICS_URLS:
            default: http://0.0.0.0:2381
          ETCD_INITIAL_CLUSTER:
            default: ${ETCD_INITIAL_CLUSTER}
          ETCD_INITIAL_CLUSTER_STATE:
            default: existing
          ETCD_INITIAL_CLUSTER_TOKEN:
            default: ${ETCD_CLUSTER_TOKEN}
        instructions:
          - title: Client Endpoint
            content: "http://${PORT_FORWARDED_HOSTNAME}:${CLIENT_PORT_FORWARDED_PORT}"
          - title: List Members
            content: "curl -X POST http://${PORT_FORWARDED_HOSTNAME}:${CLIENT_PORT_FORWARDED_PORT}/v3/cluster/member/list"
          - title: Add Member (replace service name)
            content: "curl -X POST http://${PORT_FORWARDED_HOSTNAME}:${CLIENT_PORT_FORWARDED_PORT}/v3/cluster/member/add -d '{\"peerURLs\":[\"http://etcd4:2380\"]}'"
          - title: Delete Member (replace member-id)
            content: "curl -X POST http://${PORT_FORWARDED_HOSTNAME}:${CLIENT_PORT_FORWARDED_PORT}/v3/cluster/member/remove -d '{\"ID\":\"<member-id>\"}'"
          - title: Cluster Health
            content: "curl http://${PORT_FORWARDED_HOSTNAME}:${CLIENT_PORT_FORWARDED_PORT}/health"
          - title: Put Key (test=hello)
            content: "curl -X POST http://${PORT_FORWARDED_HOSTNAME}:${CLIENT_PORT_FORWARDED_PORT}/v3/kv/put -d '{\"key\":\"dGVzdA==\",\"value\":\"aGVsbG8=\"}'"
          - title: Get Key (test)
            content: "curl -X POST http://${PORT_FORWARDED_HOSTNAME}:${CLIENT_PORT_FORWARDED_PORT}/v3/kv/range -d '{\"key\":\"dGVzdA==\"}'"

  localization:
    zh-TW:
      description: |
        å°‡é¡å¤–çš„ etcd ç¯€é»æ–°å¢åˆ°ç¾æœ‰çš„ etcd å¢é›†ã€‚ä½¿ç”¨æ­¤æ¨¡æ¿ä¾†æ“´å±•å¢é›†ä»¥ç²å¾—æ›´é«˜å¯ç”¨æ€§æˆ–æ›¿æ›æ•…éšœç¯€é»ã€‚
      variables:
        - key: ETCD_NODE_NAME
          type: STRING
          name: ç¯€é»åç¨±
          description: æ­¤ etcd ç¯€é»çš„å”¯ä¸€åç¨±ï¼ˆä¾‹å¦‚ etcd4ã€etcd5ï¼‰
        - key: ETCD_CLUSTER_TOKEN
          type: STRING
          name: å¢é›†ä»¤ç‰Œ
          description: å¢é›†ä»¤ç‰Œï¼ˆåŠ å…¥ç¾æœ‰å¢é›†æ™‚å¿…é ˆç›¸ç¬¦ï¼‰
        - key: ETCD_INITIAL_CLUSTER
          type: STRING
          name: åˆå§‹å¢é›†
          description: æ‰€æœ‰å¢é›†æˆå“¡ï¼ˆä¾‹å¦‚ etcd1=http://etcd1:2380,etcd2=http://etcd2:2380,etcd4=http://etcd4:2380ï¼‰
      readme: |
        # etcd ç¯€é»ï¼ˆå¢é›†æ“´å±•ï¼‰

        æ­¤æ¨¡æ¿å…è¨±æ‚¨å°‡é¡å¤–çš„ etcd ç¯€é»æ–°å¢åˆ°ç¾æœ‰çš„ etcd å¢é›†ã€‚

        ## ä½¿ç”¨å ´æ™¯

        1. **æ“´å±•ç¾æœ‰å¢é›†**ï¼šå¾ 3 ç¯€é»æ“´å±•åˆ° 5 ç¯€é»ä»¥ç²å¾—æ›´é«˜å¯ç”¨æ€§
        2. **æ›¿æ›æ•…éšœç¯€é»**ï¼šéƒ¨ç½²æ–°ç¯€é»ä»¥æ›¿æ›æ•…éšœçš„å¢é›†æˆå“¡

        ## é‡è¦ï¼šéƒ¨ç½²å¾Œé‡æ–°å‘½åæœå‹™

        éƒ¨ç½²æ­¤æ¨¡æ¿å¾Œï¼Œæœå‹™é è¨­åç¨±ç‚º `etcd`ã€‚**æ‚¨å¿…é ˆé‡æ–°å‘½åæœå‹™å’Œå…§éƒ¨ç¶²è·¯**ä»¥åŒ¹é…æ‚¨æƒ³è¦çš„ç¯€é»åç¨±ã€‚

        ä¾‹å¦‚ï¼Œå¦‚æœè¦æ–°å¢ç¬¬ 4 å€‹ etcd ç¯€é»ï¼š
        1. **é‡æ–°å‘½åæœå‹™**ï¼š`etcd` â†’ `etcd4`
        2. **é‡æ–°å‘½åå…§éƒ¨ç¶²è·¯**ï¼š`etcd` â†’ `etcd4`

        ## æ–°å¢åˆ°ç¾æœ‰å¢é›†

        ### æ­¥é©Ÿ 1ï¼šæ–°å¢æˆå“¡åˆ°å¢é›†

        ```bash
        curl -X POST http://etcd1:2379/v3/cluster/member/add -d '{"peerURLs":["http://etcd4:2380"]}'
        ```

        ### æ­¥é©Ÿ 2ï¼šéƒ¨ç½²æ­¤æ¨¡æ¿

        ```
        ç¯€é»åç¨±ï¼šetcd4
        å¢é›†ä»¤ç‰Œï¼šetcd-cluster-pg-ha
        åˆå§‹å¢é›†ï¼šetcd1=http://etcd1:2380,etcd2=http://etcd2:2380,etcd3=http://etcd3:2380,etcd4=http://etcd4:2380
        ```

        ### æ­¥é©Ÿ 3ï¼šé©—è­‰

        ```bash
        curl http://etcd1:2379/health
        curl -X POST http://etcd1:2379/v3/cluster/member/list
        ```

    zh-CN:
      description: |
        å°†é¢å¤–çš„ etcd èŠ‚ç‚¹æ·»åŠ åˆ°ç°æœ‰çš„ etcd é›†ç¾¤ã€‚ä½¿ç”¨æ­¤æ¨¡æ¿æ¥æ‰©å±•é›†ç¾¤ä»¥è·å¾—æ›´é«˜å¯ç”¨æ€§æˆ–æ›¿æ¢æ•…éšœèŠ‚ç‚¹ã€‚
      variables:
        - key: ETCD_NODE_NAME
          type: STRING
          name: èŠ‚ç‚¹åç§°
          description: æ­¤ etcd èŠ‚ç‚¹çš„å”¯ä¸€åç§°ï¼ˆä¾‹å¦‚ etcd4ã€etcd5ï¼‰
        - key: ETCD_CLUSTER_TOKEN
          type: STRING
          name: é›†ç¾¤ä»¤ç‰Œ
          description: é›†ç¾¤ä»¤ç‰Œï¼ˆåŠ å…¥ç°æœ‰é›†ç¾¤æ—¶å¿…é¡»åŒ¹é…ï¼‰
        - key: ETCD_INITIAL_CLUSTER
          type: STRING
          name: åˆå§‹é›†ç¾¤
          description: æ‰€æœ‰é›†ç¾¤æˆå‘˜ï¼ˆä¾‹å¦‚ etcd1=http://etcd1:2380,etcd2=http://etcd2:2380,etcd4=http://etcd4:2380ï¼‰
      readme: |
        # etcd èŠ‚ç‚¹ï¼ˆé›†ç¾¤æ‰©å±•ï¼‰

        æ­¤æ¨¡æ¿å…è®¸æ‚¨å°†é¢å¤–çš„ etcd èŠ‚ç‚¹æ·»åŠ åˆ°ç°æœ‰çš„ etcd é›†ç¾¤ã€‚

        ## ä½¿ç”¨åœºæ™¯

        1. **æ‰©å±•ç°æœ‰é›†ç¾¤**ï¼šä» 3 èŠ‚ç‚¹æ‰©å±•åˆ° 5 èŠ‚ç‚¹ä»¥è·å¾—æ›´é«˜å¯ç”¨æ€§
        2. **æ›¿æ¢æ•…éšœèŠ‚ç‚¹**ï¼šéƒ¨ç½²æ–°èŠ‚ç‚¹ä»¥æ›¿æ¢æ•…éšœçš„é›†ç¾¤æˆå‘˜

        ## é‡è¦ï¼šéƒ¨ç½²åé‡å‘½åæœåŠ¡

        éƒ¨ç½²æ­¤æ¨¡æ¿åï¼ŒæœåŠ¡é»˜è®¤åç§°ä¸º `etcd`ã€‚**æ‚¨å¿…é¡»é‡å‘½åæœåŠ¡å’Œå†…éƒ¨ç½‘ç»œ**ä»¥åŒ¹é…æ‚¨æƒ³è¦çš„èŠ‚ç‚¹åç§°ã€‚

        ä¾‹å¦‚ï¼Œå¦‚æœè¦æ·»åŠ ç¬¬ 4 ä¸ª etcd èŠ‚ç‚¹ï¼š
        1. **é‡å‘½åæœåŠ¡**ï¼š`etcd` â†’ `etcd4`
        2. **é‡å‘½åå†…éƒ¨ç½‘ç»œ**ï¼š`etcd` â†’ `etcd4`

        ## æ·»åŠ åˆ°ç°æœ‰é›†ç¾¤

        ### æ­¥éª¤ 1ï¼šæ·»åŠ æˆå‘˜åˆ°é›†ç¾¤

        ```bash
        curl -X POST http://etcd1:2379/v3/cluster/member/add -d '{"peerURLs":["http://etcd4:2380"]}'
        ```

        ### æ­¥éª¤ 2ï¼šéƒ¨ç½²æ­¤æ¨¡æ¿

        ```
        èŠ‚ç‚¹åç§°ï¼šetcd4
        é›†ç¾¤ä»¤ç‰Œï¼šetcd-cluster-pg-ha
        åˆå§‹é›†ç¾¤ï¼šetcd1=http://etcd1:2380,etcd2=http://etcd2:2380,etcd3=http://etcd3:2380,etcd4=http://etcd4:2380
        ```

        ### æ­¥éª¤ 3ï¼šéªŒè¯

        ```bash
        curl http://etcd1:2379/health
        curl -X POST http://etcd1:2379/v3/cluster/member/list
        ```

    ja-JP:
      description: |
        æ—¢å­˜ã® etcd ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã«è¿½åŠ ã® etcd ãƒãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚ã“ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¦ã€ã‚ˆã‚Šé«˜ã„å¯ç”¨æ€§ã®ãŸã‚ã«ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’æ‹¡å¼µã—ãŸã‚Šã€éšœå®³ãƒãƒ¼ãƒ‰ã‚’ç½®ãæ›ãˆãŸã‚Šã§ãã¾ã™ã€‚
      variables:
        - key: ETCD_NODE_NAME
          type: STRING
          name: ãƒãƒ¼ãƒ‰å
          description: ã“ã® etcd ãƒãƒ¼ãƒ‰ã®ä¸€æ„ã®åå‰ï¼ˆä¾‹ï¼šetcd4ã€etcd5ï¼‰
        - key: ETCD_CLUSTER_TOKEN
          type: STRING
          name: ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒˆãƒ¼ã‚¯ãƒ³
          description: ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆæ—¢å­˜ã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã«å‚åŠ ã™ã‚‹å ´åˆã¯ä¸€è‡´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼‰
        - key: ETCD_INITIAL_CLUSTER
          type: STRING
          name: åˆæœŸã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼
          description: ã™ã¹ã¦ã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒ¡ãƒ³ãƒãƒ¼ï¼ˆä¾‹ï¼šetcd1=http://etcd1:2380,etcd2=http://etcd2:2380,etcd4=http://etcd4:2380ï¼‰
      readme: |
        # etcd ãƒãƒ¼ãƒ‰ï¼ˆã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼æ‹¡å¼µï¼‰

        ã“ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¦ã€æ—¢å­˜ã® etcd ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã«è¿½åŠ ã®ãƒãƒ¼ãƒ‰ã‚’è¿½åŠ ã§ãã¾ã™ã€‚

        ## ä½¿ç”¨ã‚±ãƒ¼ã‚¹

        1. **æ—¢å­˜ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®æ‹¡å¼µ**ï¼šã‚ˆã‚Šé«˜ã„å¯ç”¨æ€§ã®ãŸã‚ã« 3 ãƒãƒ¼ãƒ‰ã‹ã‚‰ 5 ãƒãƒ¼ãƒ‰ã«æ‹¡å¼µ
        2. **éšœå®³ãƒãƒ¼ãƒ‰ã®ç½®ãæ›ãˆ**ï¼šéšœå®³ã®ã‚ã‚‹ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒ¡ãƒ³ãƒãƒ¼ã‚’ç½®ãæ›ãˆã‚‹ãŸã‚ã®æ–°ã—ã„ãƒãƒ¼ãƒ‰ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤

        ## é‡è¦ï¼šãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã®ã‚µãƒ¼ãƒ“ã‚¹åå¤‰æ›´

        ã“ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã¨ã€ã‚µãƒ¼ãƒ“ã‚¹ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ `etcd` ã¨ã„ã†åå‰ã«ãªã‚Šã¾ã™ã€‚**ã‚µãƒ¼ãƒ“ã‚¹ã¨å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ä¸¡æ–¹ã‚’**å¸Œæœ›ã®ãƒãƒ¼ãƒ‰åã«åˆã‚ã›ã¦åå‰ã‚’å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

        ä¾‹ãˆã°ã€4 ç•ªç›®ã® etcd ãƒãƒ¼ãƒ‰ã‚’è¿½åŠ ã™ã‚‹å ´åˆï¼š
        1. **ã‚µãƒ¼ãƒ“ã‚¹åã‚’å¤‰æ›´**ï¼š`etcd` â†’ `etcd4`
        2. **å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åã‚’å¤‰æ›´**ï¼š`etcd` â†’ `etcd4`

        ## æ—¢å­˜ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã¸ã®è¿½åŠ 

        ### ã‚¹ãƒ†ãƒƒãƒ— 1ï¼šã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã«ãƒ¡ãƒ³ãƒãƒ¼ã‚’è¿½åŠ 

        ```bash
        curl -X POST http://etcd1:2379/v3/cluster/member/add -d '{"peerURLs":["http://etcd4:2380"]}'
        ```

        ### ã‚¹ãƒ†ãƒƒãƒ— 2ï¼šã“ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤

        ```
        ãƒãƒ¼ãƒ‰åï¼šetcd4
        ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒˆãƒ¼ã‚¯ãƒ³ï¼šetcd-cluster-pg-ha
        åˆæœŸã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ï¼šetcd1=http://etcd1:2380,etcd2=http://etcd2:2380,etcd3=http://etcd3:2380,etcd4=http://etcd4:2380
        ```

        ### ã‚¹ãƒ†ãƒƒãƒ— 3ï¼šç¢ºèª

        ```bash
        curl http://etcd1:2379/health
        curl -X POST http://etcd1:2379/v3/cluster/member/list
        ```

    es-ES:
      description: |
        Agregue nodos etcd adicionales a un clÃºster etcd existente. Use esto para escalar su clÃºster para mayor disponibilidad o reemplazar nodos fallidos.
      variables:
        - key: ETCD_NODE_NAME
          type: STRING
          name: Nombre del nodo
          description: Nombre Ãºnico para este nodo etcd (ej. etcd4, etcd5)
        - key: ETCD_CLUSTER_TOKEN
          type: STRING
          name: Token del clÃºster
          description: Token del clÃºster (debe coincidir con el clÃºster existente si se une)
        - key: ETCD_INITIAL_CLUSTER
          type: STRING
          name: ClÃºster inicial
          description: Todos los miembros del clÃºster (ej. etcd1=http://etcd1:2380,etcd2=http://etcd2:2380,etcd4=http://etcd4:2380)
      readme: |
        # Nodo etcd (ExpansiÃ³n de clÃºster)

        Esta plantilla le permite agregar nodos etcd adicionales a un clÃºster etcd existente.

        ## Casos de uso

        1. **Expandir clÃºster existente**: Escalar de 3 a 5 nodos para mayor disponibilidad
        2. **Reemplazar nodo fallido**: Desplegar un nuevo nodo para reemplazar un miembro fallido

        ## Importante: Renombrar servicio despuÃ©s del despliegue

        Cuando despliegue esta plantilla, el servicio se llamarÃ¡ `etcd` por defecto. **Debe renombrar tanto el servicio como la red interna** para que coincidan con el nombre de nodo deseado.

        Por ejemplo, si agrega el 4Âº nodo etcd:
        1. **Renombrar servicio**: `etcd` â†’ `etcd4`
        2. **Renombrar red interna**: `etcd` â†’ `etcd4`

        ## Agregar al clÃºster existente

        ### Paso 1: Agregar miembro al clÃºster

        ```bash
        curl -X POST http://etcd1:2379/v3/cluster/member/add -d '{"peerURLs":["http://etcd4:2380"]}'
        ```

        ### Paso 2: Desplegar esta plantilla

        ```
        Nombre del nodo: etcd4
        Token del clÃºster: etcd-cluster-pg-ha
        ClÃºster inicial: etcd1=http://etcd1:2380,etcd2=http://etcd2:2380,etcd3=http://etcd3:2380,etcd4=http://etcd4:2380
        ```

        ### Paso 3: Verificar

        ```bash
        curl http://etcd1:2379/health
        curl -X POST http://etcd1:2379/v3/cluster/member/list
        ```

    id-ID:
      description: |
        Tambahkan node etcd tambahan ke kluster etcd yang ada. Gunakan ini untuk memperluas kluster Anda untuk ketersediaan lebih tinggi atau mengganti node yang gagal.
      variables:
        - key: ETCD_NODE_NAME
          type: STRING
          name: Nama Node
          description: Nama unik untuk node etcd ini (contoh etcd4, etcd5)
        - key: ETCD_CLUSTER_TOKEN
          type: STRING
          name: Token Kluster
          description: Token kluster (harus cocok dengan kluster yang ada jika bergabung)
        - key: ETCD_INITIAL_CLUSTER
          type: STRING
          name: Kluster Awal
          description: Semua anggota kluster (contoh etcd1=http://etcd1:2380,etcd2=http://etcd2:2380,etcd4=http://etcd4:2380)
      readme: |
        # Node etcd (Ekspansi Kluster)

        Template ini memungkinkan Anda menambahkan node etcd tambahan ke kluster etcd yang ada.

        ## Kasus Penggunaan

        1. **Perluas kluster yang ada**: Skala dari 3 ke 5 node untuk ketersediaan lebih tinggi
        2. **Ganti node yang gagal**: Deploy node baru untuk mengganti anggota kluster yang gagal

        ## Penting: Ganti nama layanan setelah deployment

        Saat Anda mendeploy template ini, layanan akan dinamai `etcd` secara default. **Anda harus mengganti nama layanan dan jaringan internal** agar sesuai dengan nama node yang diinginkan.

        Misalnya, jika menambahkan node etcd ke-4:
        1. **Ganti nama layanan**: `etcd` â†’ `etcd4`
        2. **Ganti nama jaringan internal**: `etcd` â†’ `etcd4`

        ## Menambah ke kluster yang ada

        ### Langkah 1: Tambahkan anggota ke kluster

        ```bash
        curl -X POST http://etcd1:2379/v3/cluster/member/add -d '{"peerURLs":["http://etcd4:2380"]}'
        ```

        ### Langkah 2: Deploy template ini

        ```
        Nama Node: etcd4
        Token Kluster: etcd-cluster-pg-ha
        Kluster Awal: etcd1=http://etcd1:2380,etcd2=http://etcd2:2380,etcd3=http://etcd3:2380,etcd4=http://etcd4:2380
        ```

        ### Langkah 3: Verifikasi

        ```bash
        curl http://etcd1:2379/health
        curl -X POST http://etcd1:2379/v3/cluster/member/list
        ```
